<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Google sign-in helper (off-screen)</title>
  <!-- Firebase Web SDK (standard, NOT web-extension) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js"></script>
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
    import { getAuth, GoogleAuthProvider, signInWithPopup } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js';

    // Same config used inside the extension
    const app = initializeApp({
      apiKey: 'AIzaSyDMRtco7UXpAvPHb3HE52_54dafHytYDpw',
      authDomain: 'pokernow-bot.firebaseapp.com',
      projectId: 'pokernow-bot',
      storageBucket: 'pokernow-bot.appspot.com',
      messagingSenderId: '54978395059',
      appId: '1:54978395059:web:8ffd353787671dc609e9c6'
    });

    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();
    const PARENT = location.ancestorOrigins[0];
    const relay = (r) => parent.postMessage(JSON.stringify(r), PARENT);

    // Wait for off-screen doc message, then run sign-in
    addEventListener('message', (e) => {
      if (e.data?.initAuth) {
        signInWithPopup(auth, provider).then(relay).catch(relay);
      }
    });
  </script>
</head>
<body></body>
</html> 